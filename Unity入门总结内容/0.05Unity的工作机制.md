## 0.05Unity的工作机制

Unity的工作机制可以简洁地总结为以下几个关键点:

1. 游戏对象(GameObject):Unity场景中的所有实体都是游戏对象,它们组成了游戏世界。
    
2. 组件(Component):游戏对象的功能由附加在其上的组件定义,如Transform、Renderer、Collider等。
    
3. 脚本(Script):用户可以编写脚本组件来定义游戏对象的行为和交互逻辑。
    
4. 场景(Scene):游戏环境由一个或多个场景组成,每个场景都是一个独立的游戏关卡或地图。
    
5. 资源(Asset):游戏中使用的所有资源,如模型、纹理、音频等,都作为资源导入并管理。
    
6. 游戏循环(Game Loop):Unity通过不断执行游戏循环来更新游戏状态和渲染画面。
    

表格进一步说明Unity的游戏循环:

|阶段|描述|
|---|---|
|初始化(Initialization)|加载资源,初始化游戏对象和组件。|
|输入事件处理(Input Events)|处理用户输入事件,如键盘、鼠标、触摸等。|
|游戏逻辑更新(Game Logic Update)|根据输入和游戏规则更新游戏对象的状态和行为。|
|物理模拟(Physics Simulation)|执行物理引擎模拟,处理碰撞、力和运动。|
|动画更新(Animation Update)|更新游戏对象的动画状态。|
|渲染(Rendering)|将游戏世界渲染为可视图像。|
|帧结束(End of Frame)|等待下一帧开始。|

Unity通过这种循环机制,不断地处理输入、更新游戏状态、模拟物理、更新动画并渲染画面,从而创造出交互式的游戏体验。


| **阶段**      | **函数/事件**            | **说明**                                |
| ----------- | -------------------- | ------------------------------------- |
| **编辑器阶段**   | `Awake()`            | 在场景加载时调用，所有对象的初始化都在这里进行，但不依赖其他对象的状态。  |
|             | `OnEnable()`         | 在对象被激活时调用，包括首次加载时以及每次激活时。             |
| **游戏开始前**   | `Start()`            | 在游戏开始后第一次更新帧前调用，通常用于依赖其他对象初始化的操作。     |
| **游戏更新阶段**  | `Update()`           | 每帧调用一次，用于处理游戏逻辑的主要部分，例如输入检测和持续的状态更新。  |
|             | `FixedUpdate()`      | 每固定时间间隔调用一次，用于处理物理计算等与帧率无关的逻辑。        |
|             | `LateUpdate()`       | 在每帧的最后调用，通常用于依赖其他对象已经更新完成的数据，例如摄像机跟随。 |
| **渲染阶段**    | `OnPreRender()`      | 在摄像机开始渲染场景前调用，可以用于在渲染前的最后调整。          |
|             | `OnRenderObject()`   | 在摄像机渲染某个对象时调用，可以在渲染过程中执行自定义渲染命令。      |
|             | `OnPostRender()`     | 在摄像机完成渲染后调用，通常用于在场景渲染结束后做最后的调整或特效处理。  |
| **物理和碰撞阶段** | `OnCollisionEnter()` | 在碰撞发生的第一帧调用，用于处理物理碰撞事件。               |
|             | `OnCollisionStay()`  | 在持续碰撞期间每帧调用，用于处理持续的碰撞逻辑。              |
|             | `OnCollisionExit()`  | 当碰撞结束时调用，用于处理碰撞结束后的逻辑。                |
| **触发器阶段**   | `OnTriggerEnter()`   | 当一个对象进入触发器时调用。                        |
|             | `OnTriggerStay()`    | 在对象停留在触发器内时每帧调用。                      |
|             | `OnTriggerExit()`    | 当对象离开触发器时调用。                          |
| **禁用和销毁阶段** | `OnDisable()`        | 在对象被禁用或销毁之前调用，用于做清理工作。                |
|             | `OnDestroy()`        | 在对象销毁时调用，用于释放资源或做最后的清理。               |

### 说明：

- **Awake 和 Start**：这两个是初始化阶段的主要函数，`Awake` 先于 `Start` 被调用。
- **Update 和 FixedUpdate**：`Update` 每帧调用，用于大部分游戏逻辑。`FixedUpdate` 是物理帧，用于物理相关的计算。
- **LateUpdate**：在 `Update` 之后调用，适合用来处理需要在其他更新之后再执行的逻辑。
- **渲染阶段**：包含了渲染前后可以插入自定义逻辑的函数。
- **碰撞和触发器**：分别处理物理碰撞和触发器事件。
- **禁用和销毁**：用于处理对象被禁用或销毁时的清理工作。